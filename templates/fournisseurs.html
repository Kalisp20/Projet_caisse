<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>Mes Fournisseurs</title>
  <!-- Bootstrap Core CSS -->
  <link href="../static/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom Fonts -->
  <link href="../static/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css">
  <link href="../static/vendor/simple-line-icons/css/simple-line-icons.css" rel="stylesheet">

  <!-- Custom CSS -->
  <link href="../static/css/stylish-portfolio.min.css" rel="stylesheet">


    <!-- Custom styles for this template -->
    <link href="../static/css/sb-admin-2.min.css" rel="stylesheet">

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <script src="../static/js/bootstable.js" ></script>


    <!-- Moment.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.23.0/moment.min.js" integrity="sha256-VBLiveTKyUZMEzJd6z2mhfxIqz3ZATCuVMawPZGzIfA=" crossorigin="anonymous"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />
    <script src="https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.12/js/dataTables.bootstrap.min.js"></script>  
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.12/css/dataTables.bootstrap.min.css" />
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/x-editable/1.5.1/bootstrap3-editable/css/bootstrap-editable.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/x-editable/1.5.1/bootstrap3-editable/js/bootstrap-editable.js"></script>

    <!-- Tempus Dominus Bootstrap 4 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.1.2/css/tempusdominus-bootstrap-4.min.css" integrity="sha256-XPTBwC3SBoWHSmKasAk01c08M6sIA5gF5+sRxqak2Qs=" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.1.2/js/tempusdominus-bootstrap-4.min.js" integrity="sha256-z0oKYg6xiLq3yJGsp/LsY9XykbweQlHl42jHv2XTBz4=" crossorigin="anonymous"></script>


   
    <script type="text/javascript" language="javascript">
      $(document).ready(function(){
        var dataTable = $('#sample_data').DataTable();
        $('#sample_data').editable({
            container:'body',
            selector:'td.num_tel',
            url:'{{ url_for('.updatefournisseur', company=company ) }}',
            title:'Numéro Tel',
            type:'POST',
            validate:function(value){
                if($.trim(value) == '')
                {
                    return 'This field is required';
                }
            }
        });

        $('#sample_data').editable({
            container:'body',
            selector:'td.email',
            url:'{{ url_for('.updatefournisseur', company=company ) }}',
            title:'Email',
            type:'POST',
            validate:function(value){
                if($.trim(value) == '')
                {
                    return 'This field is required';
                }
            }
        });


   
      }); 

      </script>
</head>

<body id="page-top">

  <!-- Navigation -->
  <a class="menu-toggle rounded" href="#">
    <i class="fas fa-bars"></i>
  </a>
  <nav id="sidebar-wrapper">
    <ul class="sidebar-nav">
      <li class="sidebar-brand">
        <a class="js-scroll-trigger" href="{{url_for('.index', company=company ) }}">Accueil</a>
      </li>
      <li class="sidebar-nav-item">
        <a class="js-scroll-trigger" href="{{url_for('.stock', company=company ) }}">Stock</a>
      </li>

      <li class="sidebar-nav-item">
        <a class="js-scroll-trigger" href="{{url_for('.caisse', company=company ) }}">Caisse</a>
      </li>
      <li class="sidebar-nav-item">
        <a class="js-scroll-trigger" href="{{url_for('.dashboard', company=company ) }}">Dashboard</a>
      </li>
      <li class="sidebar-nav-item">
        <a class="js-scroll-trigger" href="{{url_for('.logout', company=company ) }}">Se déconnecter</a>
      </li>
    </ul>
  </nav>


  <section class="py-5" style="background-image: url('../static/img/Fournisseurs.jpg');background-repeat: no-repeat;background-attachment: fixed;background-size: cover;height: 750px">
  </section>
  

  <!-- Portfolio -->
  <section class="content-section" id="portfolio" style="padding-top: 2.5rem;">
    <div class="container">
      <div class="content-section-heading text-center">
        <h2 class="mb-5">Mes fournisseurs en toute simplicité !</h2>
      </div>
      <div class="d-flex justify-content-around">
        <div class="col-lg-6 ">
            <a class="portfolio-item" data-toggle="modal" data-target="#exampleModal1" id='Rechercher'>
              <div class="caption">
                <div class="caption-content">
                  <div class="h2">Rechercher</div>
                  <p class="mb-0">Rechercher par dénomination sociale et retrouver le N°SIRET, adresse..!</p>
                </div>
              </div>
              <img class="img-fluid" src="../static/img/search.jpg" alt="" >
            </a>
          </div>
          <div class="col-lg-6 ">
            <a class="portfolio-item" href="{{url_for('.test2', company=company ) }}" id='Consulter'>
              <div class="caption">
                <div class="caption-content">
                  <div class="h2">Consulter</div>
                  <p class="mb-0">Consulter vos fournisseurs enregistrés dans votre base de donnée !</p>
                </div>
              </div>
              <img class="img-fluid" src="../static/img/consulter.jpg" alt="" >
            </a>
          </div>
      </div>
    </div>
  </section>

  <div class="modal fade" id="exampleModal1" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Rechercher par nom de la société et retrouver N°SIRET, adresse </h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form method="POST" action="{{url_for('.test', company=company ) }}" enctype="multipart/form-data">
          <div class="form-group">
            <input type="text" class="form-control form-control-user" name='search_fournisseurs' type="submit"  aria-describedby="emailHelp" placeholder="Dénomination Sociale...">
          </div>


             <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" id='close'>Close</button>
                <button type="submit" class="btn btn-primary"  name="search_fournisseurs" id ="submit">Valider</button>
                
              </div>
            </form>
            </div>
          </div>
        </div>
    </div>


    {% if no_result %}
    <div class="modal fade" id="failModal" tabindex="-1" role="dialog" aria-labelledby="successModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Fournisseur Introuvable</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
          </div>
          <div class="modal-body" data-dismiss="modal">
            <form>
              <div class="form-group">
                  <p>Veuillez modifier votre recherche !</p>
              </div>
    
               <div class="modal-footer">
                  
                  <a type="button" id='select_supplier' class="btn btn-success js-scroll-trigger" href="#table_achats">J'y vais !</a>
                  
                </div>
            
          </div>
        </div>
      </form>
      </div>
      {% endif %}
      
{% if result %}
<div class="modal fade" id="successModal" tabindex="-1" role="dialog" aria-labelledby="successModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Résultats recherche!</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
      <div class="modal-body" data-dismiss="modal">
        <form>
          <div class="form-group">
              <p>Merci de sélectionner votre fournisseur !</p>
          </div>

           <div class="modal-footer">
              
              <a type="button" class="btn btn-success js-scroll-trigger" href="#table_achats">J'y vais!</a>
              
            </div>
        
      </div>
    </div>
  </form>
  </div>
</div>
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Rechercher par nom de la société et retrouver N°SIRET, adresse </h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form method="POST" action="{{url_for('.test', company=company ) }}" enctype="multipart/form-data">
        <div class="form-group">
          <input type="text" class="form-control form-control-user" id= "input-field-id" name='select_fournisseurs' type="submit"  aria-describedby="emailHelp" >
        </div>
        <div class="form-group">
          <input type="text" class="form-control form-control-user" name='email' type="submit"  aria-describedby="emailHelp" placeholder="Adresse email">
        </div>
        <div class="form-group">
          <input type="text" class="form-control form-control-user" name='tel' type="submit"  aria-describedby="emailHelp" placeholder="Numéro téléphone">
        </div>

           <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              <button type="submit" class="btn btn-primary"  name="send_to_fournisseur" >Valider</button>
              
            </div>
          </form>
          </div>
        </div>
      </div>
  </div>

  <section  style="margin:30px;">

    <form href="{{ url_for('.test', company=company)}}" role="form" method="post" >
            <div class="panel-body">
                <div class="table-responsive">
                    <table id="table_achats" class="table table-bordered table-striped" data-toggle="modal" data-target="#exampleModal">
                        <thead>
                            <tr>
                              
                              <th>Dénomination Sociale</th>
                                <th>SIREN</th>
                                <th>SIRET</th>
                                <th>Activité Principale</th>
                                
                                <th>Numéro Voie</th>
                                <th>Libellé Voie</th>
                                <th>Code Postal</th>
                                <th>Commune</th>
                                
                                
                            </tr>
                        </thead>
                        <tbody>
                          {% for element in result['etablissement'] %}
                          
                              <td data-field="nom" class="nom" data-type="text" id="nom" data-pk="{{element['id_fournisseur']}}">{{element['nom_raison_sociale']}}</td>

             
                                <td data-field="siren" class="siren" name=siren data-type="text" data-pk="{{element['id_fournisseur']}}">{{element['siren']}}</td>
                                <td data-field="siret" class="siret" data-type="text" data-pk="{{element['id_fournisseur']}}">{{element['siret']}}</td>
                                <td data-field="activité" class="activité" data-type="text" data-pk="{{element['id_fournisseur']}}">{{element['libelle_activite_principale']}}</td>

                                <td data-field="numero_voie" class="numero_voie" data-type="text" data-pk="{{element['id_fournisseur']}}">{{element['numero_voie']}}</td>
                                <td data-field="libelle_voie" class="libelle_voie" data-type="text" data-pk="{{element['id_fournisseur']}}">{{element['libelle_voie']}}</td>
                                <td data-field="code_postal" class="code_postal"  data-type="text" data-pk="{{element['id_fournisseur']}}">{{element['code_postal']}}</td>  
                                <td data-field="libelle_commune" class="libelle_commune" data-type="text" data-pk="{{element['id_fournisseur']}}">{{element['libelle_commune']}}</td>
                            </tr>
                            {% endfor %}
                          </tbody>
                        </table>
                        
                    </div>
                </div>
    

        
        </form>
</section>
{% endif %}

{% if data %}
<div class="modal fade" id="successModal" tabindex="-1" role="dialog" aria-labelledby="successModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Retrouver la liste de vos fournisseurs !</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"  id= 'close_consult'>
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
      <div class="modal-body" data-dismiss="modal">
        <form>
          <div class="form-group">
              <p>Consulter ou modifier simplement le numéro de tel et/ou email !</p>
          </div>

           <div class="modal-footer">
              
              <a type="button" class="btn btn-success js-scroll-trigger" href="#sample_data" id='consult_supplier'>J'y vais!</a>
              
            </div>
        
      </div>
    </div>
  </form>
  </div>
</div>
<div class="modal fade" id="delete_supplier_Modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Voulez-vous supprimer ce fournisseur ?</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form method="POST" action="{{url_for('.test2', company=company ) }}" enctype="multipart/form-data">
        <div class="form-group">
          <input type="text" class="form-control form-control-user" id= "input-field-id2" name='row_remove' type="submit"  aria-describedby="emailHelp" >
        </div>

           <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              <button type="submit" class="btn btn-primary"  name="select_remove" >Valider</button>
              
            </div>
          </form>
          </div>
        </div>
      </div>
  </div>
<section  style="margin:30px;">
  <form action="{{ url_for('.test2', company=company)}}" role="form" method="post" >
    <div class="panel-body">
              <div class="table-responsive">
                  <table id="sample_data" class="table table-bordered table-striped" >
                      <thead>
                          <tr>
                            <th>ID Fournisseur</th>
                            <th>Dénomination Sociale</th>
                            <th>Activité Principale</th>
                            <th>SIRET</th>
                            <th>SIREN</th>
                            <th>Adresse</th>
                            <th>Numéro Téléphone</th>
                            <th>EMAIL</th>
                            <th>Supprimer</th>
                          </tr>
                      </thead>
                      <tbody>
                        {% for element in data %}
                        
                            <td  data-field='data_pk' name='data_pk' data-pk="{{element['id_fournisseur']}}">{{element['id_fournisseur']}}</td>
                              <td data-field="data_nom" class="data_nom" name=data_nom data-type="text" data-pk="{{element['id_fournisseur']}}" id=data_nom>{{element['nom']}}</td>
                              <td data-field="data_activité" class="data_activité" data-type="text" data-pk="{{element['id_fournisseur']}}">{{element['activité']}}</td>
                              <td data-field="data_siret" class="data_siret" data-type="text" data-pk="{{element['id_fournisseur']}}">{{element['SIRET']}}</td>
                              <td data-field="data_siren" class="data_siren" data-type="text" data-pk="{{element['id_fournisseur']}}">{{element['SIREN']}}</td>
                              <td data-field="data_adresse" class="data_adresse" data-type="text" data-pk="{{element['id_fournisseur']}}">{{element['adresse']}}</td>
                              <td data-field="num_tel" class="num_tel" data-type="text" data-pk="{{element['id_fournisseur']}}">{{element['num_tel']}}</td>
                              <td data-field="email" class="email"  data-type="text" data-pk="{{element['id_fournisseur']}}">{{element['email']}}</td>  
                              <td data-field="remove" name='remove' class="remove" data-pk="{{element['id_fournisseur']}}"><button type="button" name='remove' class="btn btn-danger" data-toggle="modal" data-target="#delete_supplier_Modal" id="DeleteButton"><span class="glyphicon glyphicon-trash"></span></button></td>
                            </tr>
                          {% endfor %}
                        </tbody>
                      </table>
                      
                    </div>
              </div>
      
      </form>
</section>
{% endif %}
  <!-- Footer -->
  <footer class="footer text-center">
    <div class="container">
      <ul class="list-inline mb-5">
        <li class="list-inline-item">
          <a class="social-link rounded-circle text-white mr-3" href="#!">
            <i class="icon-social-facebook"></i>
          </a>
        </li>
        <li class="list-inline-item">
          <a class="social-link rounded-circle text-white mr-3" href="#!">
            <i class="icon-social-twitter"></i>
          </a>
        </li>
        <li class="list-inline-item">
          <a class="social-link rounded-circle text-white" href="#!">
            <i class="icon-social-github"></i>
          </a>
        </li>
      </ul>
      <p class="text-muted small mb-0">Copyright &copy; Your Website 2020</p>
    </div>
  </footer>

  <!-- Scroll to Top Button-->
  <a class="scroll-to-top rounded js-scroll-trigger" href="#page-top">
    <i class="fas fa-angle-up"></i>
  </a>
<!-- Plugin JavaScript -->
<script src="../static/vendor/jquery-easing/jquery.easing.min.js"></script>
<!-- Custom scripts for this template -->
<script src="../static/js/stylish-portfolio.min.js"></script>


<script>
  $( "#table_achats tbody tr" ).on( "click", function() {
    
      $(this).addClass('selected').siblings().removeClass('selected');   
      var informations= []
      var value=$(this).find('td:first').html();
      
      
      var name=$(this).find('td.nom').text();
      var siren=$(this).find('td.siren').text();
      var siret=$(this).find('td.siret').text();
      var activity=$(this).find('td.activité').text();
      var street_number=$(this).find('td.numéro_voie').text();
      var street_name=$(this).find('td.libelle_voie').text();
      var city_number=$(this).find('td.code_postal').text();
      var city=$(this).find('td.libelle_commune').text();


      informations.push(name, siren,siret, activity, street_number, street_name, city_number, city)

      

      var json_string = JSON.stringify(informations)
  




console.log($('#input-field-id').val($('#input-field-id').val() + informations));
window.setTimeout(refresh_field, 3);

});


</script>

<script>
      $(function () {
          $("#successModal").modal("show");}); 
</script>
<script>
$(function () {
    $("#failModal").modal("show");}); 
</script>



<script>
$( "#sample_data tbody tr" ).delegate( "click", function() {
    var selected_row= []
    $(this).addClass('selected').siblings().removeClass('selected');  
    var name=$(this).find('td.data_nom').text();
    var id=$(this).find('td:first').html();
    selected_row.push(id,name);
    $("#delete_supplier_Modal").modal("show");
    
    console.log($('#input-field-id2').val(selected_row));
    
  });

</script>
</body>

</html>
